<form [formGroup]="formSearch">
  <div class="body-content">
    <div class="search_table">
      <div class="row">
        <div class="form-control search justify-content-center">
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input
              type="text"
              pInputText
              placeholder="Tìm kiếm theo từ khóa"
              formControlName="filter"
              (keyup.enter)="submitSearch()"
            />
          </span>
        </div>
        <div class="justify-content-center grid">
          <div class="p-field col-2 md-12 mt-1">
            <span class="p-float-label">
              <p-dropdown
                [options]="relationWithProjects"
                optionValue="value"
                optionLabel="name"
                [style]="{ width: '100%' }"
                formControlName="relationWithProject"
                (onChange)="submitSearch()"
              ></p-dropdown>
              <label>Loại dự án</label>
            </span>
          </div>
          <div class="p-field col-2 md-12 mt-1">
            <span class="p-float-label">
              <p-multiSelect
                optionLabel="name"
                optionValue="value"
                appendTo="body"
                [options]="areas"
                optionLabel="name"
                formControlName="areas"
              >
              </p-multiSelect>
              <label>Khu vực</label>
            </span>
          </div>
          <div class="p-field col-2 md-12 mt-1">
            <span class="p-float-label">
              <p-multiSelect
                optionLabel="name"
                optionValue="value"
                appendTo="body"
                [options]="fields"
                optionLabel="name"
                formControlName="fields"
              >
              </p-multiSelect>
              <label>Lĩnh vực của dự án</label>
            </span>
          </div>
          <div class="p-field col-2 md-12 mt-1">
            <span class="p-float-label">
              <p-multiSelect
                optionLabel="name"
                optionValue="value"
                appendTo="body"
                [options]="projectStages"
                optionLabel="name"
                formControlName="stages"
              >
              </p-multiSelect>
              <label>Giai đoạn của dự án</label>
            </span>
          </div>
          <div class="p-field col-2 md-12 mt-1">
            <span class="p-float-label">
              <p-multiSelect
                optionLabel="name"
                optionValue="value"
                appendTo="body"
                [options]="availableTimes"
                optionLabel="name"
                formControlName="availableTimes"
              >
              </p-multiSelect>
              <label>Thời gian yêu cầu</label>
            </span>
          </div>
          <div class="col-2 flex justify-content-center mt-2">
            <p-button icon="pi pi-search" (onClick)="submitSearch()"></p-button>
            <p-button
              class="ml-4"
              icon="pi pi-times"
              (onClick)="clearSearch()"
            ></p-button>
          </div>
        </div>
      </div>
    </div>
    <div class="flex mt-2" style="padding: 10px; justify-content: flex-end">
      <button
        pButton
        type="button"
        label="Thêm mới dự án"
        (click)="isVisibleAddProject = true"
      ></button>
    </div>
    <p-dataView [value]="listProject" *ngIf="listProject.length > 0">
      <ng-template let-project pTemplate="listItem">
        <div class="col-12 md:col-4" style="padding: 30px">
          <app-project-item
            [project]="project"
            [relationWithProject]="formSearch.value.relationWithProject"
            (request)="requestToProject($event)"
            (accept)="acceptRequestFromProject($event)"
            (accept)="cancelRequestToProject($event)"
          ></app-project-item>
        </div>
      </ng-template>
    </p-dataView>
    <div class="grid mt-4">
      <div
        class="grid flex justify-content-center"
        style="padding-left: 10%; padding-right: 10%"
      >
        <ng-container *ngIf="listProject.length == 0">
          <img
            class="col-8 flex justify-content-center"
            width="50px"
            src="../../../../assets/img/nodata.jpg"
            alt=""
          />
        </ng-container>
      </div>
      <div class="col-12 flex justify-content-center">
        <p-paginator
          [pageLinkSize]="pageSize"
          [rows]="pageSize"
          [totalRecords]="totalRecords"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} project"
          [showCurrentPageReport]="true"
          [rowsPerPageOptions]="pageSizeOptions"
          (onPageChange)="onPageChange($event)"
        ></p-paginator>
      </div>
    </div>
  </div>
</form>

<ng-container *ngIf="isVisibleAddProject">
  <app-add-new-project
    [display]="isVisibleAddProject"
    (close)="isVisibleAddProject = false"
  ></app-add-new-project>
</ng-container>
